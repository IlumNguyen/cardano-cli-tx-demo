### ĐĂNG KÝ ỦY THÁC VÀO POOL ###

### Bước 1: Cần đăng ký "stake key" của mình trên blockchain 
### việc đăng ký sẽ yêu cầu đặt cọc 2 ADA theo như tham số đã cài đặt trên mạng lưới ###
cardano-cli conway stake-address registration-certificate \
  --stake-verification-key-file stake.vkey \
  --key-reg-deposit-amt 2000000 \
  --out-file registration.cert

### Bước 2: Xây dựng chứng chỉ đăng ký, giao dịch này yêu cầu được ký bởi payment.skey và stake.skey
cardano-cli conway transaction build \
--testnet-magic 1 \
--witness-override 2 \
--tx-in $(cardano-cli query utxo --address $(cat payment-0.addr) --testnet-magic 1 --out-file /dev/stdout | jq -r 'keys[]' | head -n 1) \
--change-address $(cat payment-0.addr) \
--certificate-file registration.cert \
--out-file tx.raw

###Ký giao dịch ủy thác bằng cả 2 key
cardano-cli transaction sign \
--tx-body-file tx.raw \
--signing-key-file payment-0.skey \
--signing-key-file stake.skey \
--testnet-magic 1 \
--out-file tx.signed

cardano-cli transaction submit \
--testnet-magic 1 \
--tx-file tx.signed 

----
cardano-cli conway stake-address registration-certificate \
--stake-verification-key-file stake.vkey \
--stake-pool-id baba8f13322b33c1ebc2bf1e805bd8ee5300657ff2c0f0749bc892e2 \
--out-file delegation.cert

cardano-cli conway stake-address stake-delegation-certificate
